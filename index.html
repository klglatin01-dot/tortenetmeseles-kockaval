<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8" />
  <title>T√∂rt√©netkock√°k ‚Äì Mes√©lj 5 dob√°sb√≥l</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #f3f5ff;
      --bg-gradient: radial-gradient(circle at top, #ffffff 0, #dde7ff 45%, #c3d4ff 100%);
      --card-bg: #ffffff;
      --card-border: #d1d9ff;
      --accent: #3b82f6;
      --accent-dark: #1d4ed8;
      --accent-soft: rgba(59, 130, 246, 0.12);
      --danger: #ef4444;
      --success: #16a34a;
      --text-main: #111827;
      --text-muted: #6b7280;
      --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.15);
      --radius-lg: 18px;
      --radius-xl: 24px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      color: var(--text-main);
      background: var(--bg-gradient);
      display: flex;
      justify-content: center;
      padding: 24px 12px;
    }

    .app {
      width: 100%;
      max-width: 1180px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 28px;
      box-shadow: var(--shadow-soft);
      padding: 20px 24px 24px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      backdrop-filter: blur(8px);
    }

    .app-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .title-block h1 {
      margin: 0;
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    .title-block p {
      margin: 4px 0 0;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .controls-main {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    button {
      border-radius: 999px;
      border: none;
      padding: 9px 16px;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: background 0.15s, transform 0.05s, box-shadow 0.15s;
      white-space: nowrap;
    }

    button:active {
      transform: translateY(1px);
      box-shadow: none;
    }

    .btn-primary {
      background: var(--accent);
      color: #ffffff;
      box-shadow: 0 8px 18px rgba(37, 99, 235, 0.35);
    }

    .btn-primary:hover {
      background: var(--accent-dark);
    }

    .btn-ghost {
      background: rgba(255, 255, 255, 0.9);
      color: var(--text-main);
      border: 1px solid #e5e7eb;
    }

    .btn-ghost:hover {
      background: #f3f4ff;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(260px, 1.4fr);
      gap: 18px;
    }

    @media (max-width: 960px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .main-column {
      background: #f8f9ff;
      border-radius: var(--radius-xl);
      padding: 16px 16px 18px;
      border: 1px solid #e0e7ff;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .side-column {
      background: var(--card-bg);
      border-radius: var(--radius-xl);
      padding: 16px 16px 18px;
      border: 1px solid #e5e7f5;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .dice-row {
      display: grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      gap: 10px;
    }

    @media (max-width: 720px) {
      .dice-row {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    .dice-card {
      background: var(--card-bg);
      border-radius: var(--radius-lg);
      padding: 8px 8px 12px;
      border: 1px solid var(--card-border);
      box-shadow: 0 8px 16px rgba(15, 23, 42, 0.06);
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .dice-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.07em;
      color: var(--text-muted);
    }

    .badge {
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: var(--accent-soft);
      color: var(--accent-dark);
      font-weight: 600;
    }

    .dice-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
      padding-top: 4px;
    }

    /* √öj: 2D ‚Äûkocka‚Äù, mindig egy oldal, olvashat√≥ emoji */
    .dice {
      width: 54px;
      height: 54px;
      border-radius: 18px;
      background: linear-gradient(135deg, #ffffff, #e5edff);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.7rem;
      box-shadow: 0 14px 25px rgba(15, 23, 42, 0.25);
      border: 1px solid #d1ddff;
      cursor: pointer;
      transition: transform 0.15s;
    }

    .dice:hover {
      transform: translateY(-2px);
    }

    .dice.shake {
      animation: shake 0.45s ease-out;
    }

    @keyframes shake {
      0%   { transform: translateY(0) rotate(0deg); }
      20%  { transform: translateY(-3px) rotate(-5deg); }
      40%  { transform: translateY(2px) rotate(4deg); }
      60%  { transform: translateY(-2px) rotate(-3deg); }
      80%  { transform: translateY(1px) rotate(2deg); }
      100% { transform: translateY(0) rotate(0deg); }
    }

    .dice-help {
      text-align: center;
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .results-row {
      display: grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      gap: 10px;
    }

    @media (max-width: 720px) {
      .results-row {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    .result-card {
      background: #fdfdff;
      border-radius: var(--radius-lg);
      border: 1px dashed #c4cff2;
      padding: 7px 8px 8px;
      min-height: 70px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .result-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .result-text {
      font-size: 0.9rem;
      color: var(--text-main);
    }

    .result-empty {
      font-size: 0.85rem;
      color: #a1a8c3;
      font-style: italic;
    }

    .sentence-builder {
      margin-top: 4px;
      background: var(--card-bg);
      border-radius: 20px;
      padding: 10px 12px;
      border: 1px solid var(--card-border);
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .sentence-label-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .sentence-label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      font-weight: 600;
    }

    .sentence-text {
      font-size: 0.95rem;
      min-height: 24px;
    }

    .sentence-placeholder {
      color: #9ca3af;
      font-style: italic;
    }

    .copy-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .side-header {
      font-size: 0.95rem;
      font-weight: 600;
      margin: 0;
    }

    .side-sub {
      margin: 2px 0 4px;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .help-section {
      border-radius: 16px;
      border: 1px solid #e5e7f5;
      padding: 8px 9px;
      background: #f9f9ff;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .help-title {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--text-main);
    }

    .help-title span {
      font-size: 1rem;
    }

    .help-list {
      margin: 4px 0 0 14px;
      padding: 0;
      color: var(--text-muted);
      font-size: 0.8rem;
    }

    .help-list li {
      margin-bottom: 2px;
    }

    .toast {
      position: fixed;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
      background: #111827;
      color: #f9fafb;
      padding: 8px 14px;
      border-radius: 999px;
      font-size: 0.8rem;
      box-shadow: 0 18px 30px rgba(15, 23, 42, 0.35);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease-out, transform 0.2s ease-out;
      z-index: 50;
    }

    .toast.visible {
      opacity: 1;
      transform: translate(-50%, -4px);
    }

    .pill {
      font-size: 0.7rem;
      border-radius: 999px;
      padding: 1px 8px;
      background: rgba(15, 118, 110, 0.08);
      color: #0f766e;
      border: 1px solid rgba(45, 212, 191, 0.6);
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="title-block">
        <h1>T√∂rt√©netkock√°k ‚Äì Mes√©lj 5 dob√°sb√≥l</h1>
        <p>Kattints a kock√°kra, √©s √©p√≠ts r√∂vid t√∂rt√©netet: H≈ës, Helysz√≠n, Konfliktus, Bonyodalom, Megold√°s.</p>
      </div>
      <div class="controls-main">
        <button id="rollAllBtn" class="btn-primary">
          üé≤ √ñsszes kocka dob√°sa
        </button>
        <button id="clearBtn" class="btn-ghost">
          ‚ôªÔ∏è V√°laszt√°sok t√∂rl√©se
        </button>
      </div>
    </header>

    <main class="layout">
      <!-- Bal oldal ‚Äì kock√°k, eredm√©nyek, mondat -->
      <section class="main-column" aria-label="T√∂rt√©netkock√°k">
        <div class="dice-row">
          <div class="dice-card" data-category="hero">
            <div class="dice-card-header">
              <span>H≈ës</span>
              <span class="badge">Kattints a dob√°shoz</span>
            </div>
            <div class="dice-wrapper">
              <div class="dice" role="button" aria-label="H≈ës dob√°sa">
                <span>üßí</span>
              </div>
            </div>
            <div class="dice-help">Ki a f≈ëszerepl≈ë?</div>
          </div>

          <div class="dice-card" data-category="place">
            <div class="dice-card-header">
              <span>Helysz√≠n</span>
              <span class="badge">Kattints a dob√°shoz</span>
            </div>
            <div class="dice-wrapper">
              <div class="dice" role="button" aria-label="Helysz√≠n dob√°sa">
                <span>üìç</span>
              </div>
            </div>
            <div class="dice-help">Hol j√°tsz√≥dik?</div>
          </div>

          <div class="dice-card" data-category="conflict">
            <div class="dice-card-header">
              <span>Konfliktus</span>
              <span class="badge">Kattints a dob√°shoz</span>
            </div>
            <div class="dice-wrapper">
              <div class="dice" role="button" aria-label="Konfliktus dob√°sa">
                <span>‚ö°</span>
              </div>
            </div>
            <div class="dice-help">Mi a probl√©ma?</div>
          </div>

          <div class="dice-card" data-category="complication">
            <div class="dice-card-header">
              <span>Bonyodalom</span>
              <span class="badge">Kattints a dob√°shoz</span>
            </div>
            <div class="dice-wrapper">
              <div class="dice" role="button" aria-label="Bonyodalom dob√°sa">
                <span>üåÄ</span>
              </div>
            </div>
            <div class="dice-help">Mit≈ël lesz m√©g nehezebb?</div>
          </div>

          <div class="dice-card" data-category="resolution">
            <div class="dice-card-header">
              <span>Megold√°s</span>
              <span class="badge">Kattints a dob√°shoz</span>
            </div>
            <div class="dice-wrapper">
              <div class="dice" role="button" aria-label="Megold√°s dob√°sa">
                <span>üåà</span>
              </div>
            </div>
            <div class="dice-help">Hogyan rendez≈ëdik?</div>
          </div>
        </div>

        <div class="results-row" aria-label="Kiv√°lasztott elemek">
          <div class="result-card" data-result="hero">
            <div class="result-label">
              <span>H≈ës</span>
              <span class="pill">Ki? Mi?</span>
            </div>
            <div class="result-text result-empty">M√©g nincs kiv√°lasztva.</div>
          </div>

          <div class="result-card" data-result="place">
            <div class="result-label">
              <span>Helysz√≠n</span>
              <span class="pill">Hol?</span>
            </div>
            <div class="result-text result-empty">M√©g nincs kiv√°lasztva.</div>
          </div>

          <div class="result-card" data-result="conflict">
            <div class="result-label">
              <span>Konfliktus</span>
              <span class="pill">Mi a gond?</span>
            </div>
            <div class="result-text result-empty">M√©g nincs kiv√°lasztva.</div>
          </div>

          <div class="result-card" data-result="complication">
            <div class="result-label">
              <span>Bonyodalom</span>
              <span class="pill">Mi rontja tov√°bb?</span>
            </div>
            <div class="result-text result-empty">M√©g nincs kiv√°lasztva.</div>
          </div>

          <div class="result-card" data-result="resolution">
            <div class="result-label">
              <span>Megold√°s</span>
              <span class="pill">Hogyan z√°rul?</span>
            </div>
            <div class="result-text result-empty">M√©g nincs kiv√°lasztva.</div>
          </div>
        </div>

        <div class="sentence-builder">
          <div class="sentence-label-row">
            <div class="sentence-label">Egysoros t√∂rt√©net</div>
            <div class="copy-buttons">
              <button id="copyPicksBtn" class="btn-ghost" style="padding-inline:10px;">
                üìã V√°laszt√°sok m√°sol√°sa
              </button>
              <button id="copySentenceBtn" class="btn-primary" style="padding-inline:10px;">
                ‚úÇÔ∏è Mondat m√°sol√°sa
              </button>
            </div>
          </div>
          <div id="sentenceOutput" class="sentence-text sentence-placeholder">
            Dobj a kock√°kkal, √©s itt automatikusan megjelenik egy egysoros t√∂rt√©net.
          </div>
        </div>
      </section>

      <!-- Jobb oldal ‚Äì seg√≠t≈ë nyelvezet -->
      <aside class="side-column" aria-label="Seg√≠t≈ë nyelvezet">
        <header>
          <h2 class="side-header">Seg√≠t≈ë mondatkezd√©sek</h2>
          <p class="side-sub">
            Ezekkel a nyelvi panelek seg√≠ts√©g√©vel a di√°kok k√∂nnyebben fel√©p√≠thetik a t√∂rt√©netet magyarul.
          </p>
        </header>

        <div id="helpSections">
          <!-- JS t√∂lti be -->
        </div>
      </aside>
    </main>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    // ------------------- Adathalmazok -------------------
    const DATASETS = {
      hero: [
        { icon: "üßí", text: "egy k√≠v√°ncsi √∂t√∂dikes" },
        { icon: "üßë‚Äçüè´", text: "egy kiss√© szigor√∫ tan√°r" },
        { icon: "üßô‚Äç‚ôÇÔ∏è", text: "egy kezd≈ë var√°zsl√≥" },
        { icon: "üßë‚ÄçüöÄ", text: "egy b√°tor ≈±rhaj√≥s" },
        { icon: "üê±", text: "egy besz√©l≈ë macska" },
        { icon: "üê∂", text: "egy t√∫lbuzg√≥ kutya" },
        { icon: "üßë‚Äçüíª", text: "egy j√°t√©kfejleszt≈ë di√°k" },
        { icon: "üßù‚Äç‚ôÄÔ∏è", text: "egy titokzatos t√ºndel√°ny" },
        { icon: "ü§¥", text: "egy √°lmos herceg" },
        { icon: "üßü‚Äç‚ôÇÔ∏è", text: "egy bar√°ts√°gos zombi" }
      ],
      place: [
        { icon: "üè´", text: "az iskola folyos√≥j√°n" },
        { icon: "üè∞", text: "egy elhagyatott kast√©lyban" },
        { icon: "üåã", text: "egy m≈±k√∂d≈ë vulk√°n tetej√©n" },
        { icon: "üõ∞Ô∏è", text: "egy ≈±r√°llom√°son" },
        { icon: "üå≥", text: "az iskola udvar√°n" },
        { icon: "üß™", text: "a term√©szettudom√°nyi laborban" },
        { icon: "üèûÔ∏è", text: "egy rejtett v√∂lgyben" },
        { icon: "üöÇ", text: "egy zakatol√≥ vonaton" },
        { icon: "üèôÔ∏è", text: "egy j√∂v≈ëbeli v√°rosban" },
        { icon: "üèùÔ∏è", text: "egy kietlen szigeten" }
      ],
      conflict: [
        { icon: "‚ö°", text: "titokzatosan elt≈±nik a h√°zi feladat" },
        { icon: "üö´", text: "valaki lekapcsolja az eg√©sz iskola √°ram√°t" },
        { icon: "üò±", text: "egy tiltott gomb megnyom√°sa mindent megv√°ltoztat" },
        { icon: "üìâ", text: "egy fontos verseny el≈ëtt mindenki megbetegszik" },
        { icon: "üï≥Ô∏è", text: "valaki elrontja az id≈ëg√©pet" },
        { icon: "üî•", text: "a legjobb bar√°t hirtelen elt≈±nik" },
        { icon: "üßä", text: "egy ≈ësi √°tok aktiv√°l√≥dik" },
        { icon: "üí£", text: "a v√°rosra √∂r√∂k s√∂t√©ts√©g borul" },
        { icon: "üò®", text: "a telefonok hirtelen √©letre kelnek" },
        { icon: "ü§Ø", text: "valaki ellopja az oszt√°ly kabalafigur√°j√°t" }
      ],
      complication: [
        { icon: "üåÄ", text: "a szerepl≈ëknek csak egyetlen √≥r√°juk marad" },
        { icon: "‚è≥", text: "senki nem eml√©kszik pontosan, mi t√∂rt√©nt" },
        { icon: "üîÅ", text: "√∫jabb szerepl≈ë t≈±nik el nyomtalanul" },
        { icon: "üåßÔ∏è", text: "a seg√≠ts√©gk√©nt h√≠vott feln≈ëttek sem hisznek nekik" },
        { icon: "üß©", text: "egy f√©lresiker√ºlt var√°zslat mindent fejre √°ll√≠t" },
        { icon: "üìµ", text: "elkezd szakadni az es≈ë az √©p√ºleten bel√ºl is" },
        { icon: "üöß", text: "a nyomok teljesen ellentmondanak egym√°snak" },
        { icon: "üå™Ô∏è", text: "egy v√°ratlan √°ramsz√ºnet mindent le√°ll√≠t" },
        { icon: "üôà", text: "a h≈ës√∂k √∂sszevesznek egym√°ssal" },
        { icon: "üß±", text: "a megold√°shoz egy titkos k√≥dot kell megfejteni√ºk" }
      ],
      resolution: [
        { icon: "üåà", text: "a szerepl≈ëk √∂sszefognak √©s megoldj√°k a rejt√©lyt" },
        { icon: "üéâ", text: "kider√ºl, hogy a hib√°b√≥l valami j√≥ sz√ºletik" },
        { icon: "ü§ù", text: "valaki bocs√°natot k√©r, √©s minden rendez≈ëdik" },
        { icon: "üèÜ", text: "egy v√°ratlan seg√≠t≈ë √©rkezik" },
        { icon: "üí°", text: "a h≈ës√∂k fontos leck√©t tanulnak a bar√°ts√°gr√≥l" },
        { icon: "üòä", text: "minden vissza√°ll a r√©gi ker√©kv√°g√°sba, de egy kicsit mindenki megv√°ltozik" },
        { icon: "üìò", text: "a rejt√©ly megold√°sa vid√°m √ºnnepl√©sbe torkollik" },
        { icon: "üïäÔ∏è", text: "a h≈ës√∂k √∫j szab√°lyokat vezetnek be, hogy ez t√∂bb√© ne t√∂rt√©nhessen meg" },
        { icon: "üåü", text: "a kudarc ellen√©re r√°j√∂nnek, hogy egy√ºtt er≈ësebbek" },
        { icon: "‚úÖ", text: "a t√∂rt√©net b√©k√©s, rem√©nyteli hangulatban z√°rul" }
      ]
    };

    const HELP_TEXT = {
      hero: {
        label: "H≈ës",
        icon: "üßí",
        items: [
          "A t√∂rt√©net f≈ëszerepl≈ëje ...",
          "A t√∂rt√©net arr√≥l sz√≥l, hogy ...",
          "A t√∂rt√©net elej√©n megismerj√ºk ..."
        ]
      },
      place: {
        label: "Helysz√≠n",
        icon: "üìç",
        items: [
          "A t√∂rt√©net egy ...-ban/ben j√°tsz√≥dik.",
          "Minden egy ...-ban/ben kezd≈ëdik.",
          "A helysz√≠n k√ºl√∂nlegess√©ge, hogy ..."
        ]
      },
      conflict: {
        label: "Konfliktus",
        icon: "‚ö°",
        items: [
          "A probl√©ma az, hogy ...",
          "A baj akkor kezd≈ëdik, amikor ...",
          "Hirtelen az t√∂rt√©nik, hogy ..."
        ]
      },
      complication: {
        label: "Bonyodalom",
        icon: "üåÄ",
        items: [
          "Hogy m√©g rosszabb legyen, ...",
          "A helyzet tov√°bb bonyol√≥dik, amikor ...",
          "Ezen fel√ºl az is nehez√≠ti a dolgot, hogy ..."
        ]
      },
      resolution: {
        label: "Megold√°s",
        icon: "üåà",
        items: [
          "A v√©g√©n ...",
          "V√©g√ºl siker√ºl ...",
          "Ennek eredm√©nyek√©nt ..."
        ]
      }
    };

    const CATEGORIES = ["hero", "place", "conflict", "complication", "resolution"];

    const currentChoices = {
      hero: null,
      place: null,
      conflict: null,
      complication: null,
      resolution: null
    };

    // ------------------- Seg√©df√ºggv√©nyek -------------------
    function randomOf(array) {
      return array[Math.floor(Math.random() * array.length)];
    }

    function showToast(message) {
      const toast = document.getElementById("toast");
      toast.textContent = message;
      toast.classList.add("visible");
      clearTimeout(showToast._timeout);
      showToast._timeout = setTimeout(() => {
        toast.classList.remove("visible");
      }, 1800);
    }

    function updateResultUI(category) {
      const card = document.querySelector(`.result-card[data-result="${category}"]`);
      if (!card) return;
      const resultDiv = card.querySelector(".result-text");
      const choice = currentChoices[category];

      if (!choice) {
        resultDiv.textContent = "M√©g nincs kiv√°lasztva.";
        resultDiv.classList.add("result-empty");
      } else {
        resultDiv.textContent = choice.text;
        resultDiv.classList.remove("result-empty");
      }
    }

    function buildSentence() {
      const { hero, place, conflict, complication, resolution } = currentChoices;
      const output = document.getElementById("sentenceOutput");

      if (!hero && !place && !conflict && !complication && !resolution) {
        output.textContent = "Dobj a kock√°kkal, √©s itt automatikusan megjelenik egy egysoros t√∂rt√©net.";
        output.classList.add("sentence-placeholder");
        return;
      }

      const h = hero ? hero.text : "valaki";
      const p = place ? place.text : "valahol";
      const c = conflict ? conflict.text : "valami furcsa t√∂rt√©nik";
      const b = complication ? complication.text : "a helyzet egyre nehezebb lesz";
      const r = resolution ? resolution.text : "v√©g√ºl minden rendez≈ëdik";

      const sentence =
        `A t√∂rt√©net h≈ëse ${h}, aki ${p}, amikor ${c}. ` +
        `Hogy m√©g bonyolultabb legyen, ${b}, de ${r}.`;

      output.textContent = sentence;
      output.classList.remove("sentence-placeholder");
    }

    function choiceFor(category) {
      const dataset = DATASETS[category];
      if (!dataset) return null;
      return randomOf(dataset);
    }

    function rollCategory(category) {
      const card = document.querySelector(`.dice-card[data-category="${category}"]`);
      if (!card) return;
      const dice = card.querySelector(".dice");

      // ‚Äûdob√°s‚Äù ‚Äì finom remeg√©s, de az emoji mindig olvashat√≥ marad
      dice.classList.remove("shake");
      void dice.offsetWidth; // reflow, hogy √∫jra lehessen ind√≠tani az anim√°ci√≥t
      dice.classList.add("shake");

      const pick = choiceFor(category);
      currentChoices[category] = pick;

      const span = dice.querySelector("span");
      if (span) span.textContent = pick.icon;

      updateResultUI(category);
      buildSentence();
    }

    function clearAll() {
      CATEGORIES.forEach(cat => {
        currentChoices[cat] = null;
        updateResultUI(cat);

        const card = document.querySelector(`.dice-card[data-category="${cat}"]`);
        const dice = card && card.querySelector(".dice");
        if (dice) {
          const span = dice.querySelector("span");
          const defaultIcon =
            cat === "hero" ? "üßí" :
            cat === "place" ? "üìç" :
            cat === "conflict" ? "‚ö°" :
            cat === "complication" ? "üåÄ" : "üåà";
          if (span) span.textContent = defaultIcon;
        }
      });
      buildSentence();
    }

    function copyPicksToClipboard() {
      const parts = [];
      CATEGORIES.forEach(cat => {
        const label =
          cat === "hero" ? "H≈ës" :
          cat === "place" ? "Helysz√≠n" :
          cat === "conflict" ? "Konfliktus" :
          cat === "complication" ? "Bonyodalom" :
          "Megold√°s";
        const choice = currentChoices[cat];
        parts.push(`${label}: ${choice ? choice.text : "‚Äî"}`);
      });
      const text = parts.join("\n");
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text)
          .then(() => showToast("A v√°laszt√°sok a v√°g√≥lapra ker√ºltek."))
          .catch(() => showToast("Nem siker√ºlt a m√°sol√°s."));
      } else {
        showToast("A b√∂ng√©sz≈ë nem t√°mogatja a v√°g√≥lap-m√°sol√°st.");
      }
    }

    function copySentenceToClipboard() {
      const output = document.getElementById("sentenceOutput");
      const text = output.textContent.trim();
      if (!text) return;
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text)
          .then(() => showToast("Az egysoros t√∂rt√©net a v√°g√≥lapra ker√ºlt."))
          .catch(() => showToast("Nem siker√ºlt a m√°sol√°s."));
      } else {
        showToast("A b√∂ng√©sz≈ë nem t√°mogatja a v√°g√≥lap-m√°sol√°st.");
      }
    }

    function buildHelpSections() {
      const container = document.getElementById("helpSections");
      Object.entries(HELP_TEXT).forEach(([key, config]) => {
        const wrapper = document.createElement("section");
        wrapper.className = "help-section";

        const title = document.createElement("div");
        title.className = "help-title";
        const labelSpan = document.createElement("span");
        labelSpan.textContent = config.label;
        const iconSpan = document.createElement("span");
        iconSpan.textContent = config.icon;
        title.appendChild(labelSpan);
        title.appendChild(iconSpan);

        const list = document.createElement("ul");
        list.className = "help-list";
        config.items.forEach(item => {
          const li = document.createElement("li");
          li.textContent = item;
          list.appendChild(li);
        });

        wrapper.appendChild(title);
        wrapper.appendChild(list);

        container.appendChild(wrapper);
      });
    }

    // ------------------- Inicializ√°l√°s -------------------
    document.addEventListener("DOMContentLoaded", () => {
      // Kock√°k kattint√°sa
      document.querySelectorAll(".dice-card").forEach(card => {
        const category = card.getAttribute("data-category");
        const dice = card.querySelector(".dice");
        dice.addEventListener("click", () => rollCategory(category));
      });

      document.getElementById("rollAllBtn").addEventListener("click", () => {
        let delay = 0;
        CATEGORIES.forEach(cat => {
          setTimeout(() => rollCategory(cat), delay);
          delay += 120;
        });
      });

      document.getElementById("clearBtn").addEventListener("click", clearAll);
      document.getElementById("copyPicksBtn").addEventListener("click", copyPicksToClipboard);
      document.getElementById("copySentenceBtn").addEventListener("click", copySentenceToClipboard);

      buildHelpSections();
      buildSentence();
    });
  </script>
</body>
</html>
